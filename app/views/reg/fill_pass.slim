/h2
/  |注册
/
/= simple_form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f|
/  = f.error_notification
/  .form-inputs
/    = f.input :mobile, required: true, autofocus: true
/    = f.input :password, required: true, hint: ("#{@minimum_password_length} characters minimum" if @minimum_password_length)
/    = f.input :password_confirmation, required: true
/    = f.input :promotion, as: :hidden, :input_html => { :value => @promotion }
/  .form-actions
/    = f.button :submit, "注册"
/= link_to "登入", orders_path
/h2
  /  |登录
  /
  /= simple_form_for(resource, as: resource_name, url: session_path(resource_name)) do |f|
  /  .form-inputs
  /    = f.input :login, required: false, autofocus: true
  /    = f.input :password, required: false
  /    = f.input :remember_me, as: :boolean if devise_mapping.rememberable?
  /  .form-actions
  /    = f.button :submit, "登入"
  /= link_to "注册", new_user_registration_path
.md-login.center.clear
  .left.fl
    = image_tag ("loginpic.jpg")
  .right.fr
    = form_tag(reset_pass_path, method: "post", id:"regForm") do |f|

      .login-box.reg-box
        .field
          label.f12 for="username"  手机号码：
          input#reg_phone type="text" name="reg_ph" placeholder="请输入手机号码" maxlength="32" value=@reg_phone disabled="true"
          /span.errmsg#phone_exist
          /input#username.username maxlength="32" name="username" placeholder="请输入手机号码" tabindex="1" type="text" value="" /
        #phonemsg


        input#promotion type="hidden" name="reg_phone"  maxlength="32" value=@reg_phone

        .field.m-t-10
          label.f12 for="passwd"  用户密码：
          input.passwd#reg_password type="password" name="reg_password" placeholder="请输入密码" maxlength="32"
        #passwdmsg
        .field.m-t-10
          label.f12 for="passwd1"  再次输入密码：
          input.passwd1#reg_password_confirm type="password" name="reg_password_confirm" placeholder="请重新输入密码" maxlength="32"
          /input#passwd1.passwd1 maxlength="32" name="passwd1" placeholder="请再次输入密码" tabindex="1" type="password" value="" /
        #passconfirmmsg

        .field.submit.m-t-10
          button#submitbtn tabindex="5" type="submit"  重设&nbsp;&nbsp;密码
          p.rt.reg
            a.f12.f-3366cc href="/users/sign_in"  用户登录




javascript:
  var count = 0;
  var counter;

  $(document).ready(function (){

    var optionsphone = {
      beforeSubmit: function () {
        return $('#regForm').validate().form()
      },

      url: '/reset_pass', // override for form's 'action' attribute
      type: 'post', // 'get' or 'post', override for form's 'method' attribute
      dataType: 'script', // 'xml', 'script', or 'json' (expected server response type)
      clearForm: false // clear all form fields after successful submit
      //resetForm: true        // reset the form after successful submit
    };


    $("#regForm").validate({
      focusInvalid: true,
      focusCleanup: true,
      onsubmit: true,
      onkeyup: false,
      rules: {
        reg_password: {
          required: true,
          minlength: 8
        },
        reg_password_confirm: {
          required: true,
          minlength: 8,
          equalTo: "#reg_password"
        }



      },
      messages: {
        reg_password: {
          required: "密码不能为空",
          minlength: "密码不能少于8位"
        },
        reg_password_confirm: {
          required: "密码不能为空",
          minlength: "密码不能少于8位",
          equalTo: "确认密码不一致"
        }

      },

      success: function (label, element) {
        $(element).popover('destroy');
      },
      submitHandler: function (form) {

        // do other things for a valid form
        if ($('#regForm').validate().form()) {
          form.submit();
        }
        else {
          alert("no");
        }
      },

      errorPlacement: function (error, element) {
         error.appendTo(element.parent().next());
      },
      errorClass: "alert errmsg",
      errorElement: "span"
    });




  });

  function timer() {
    count = count - 1;
    if (count <= 0) {
      clearInterval(counter);
      $('#timer').html("");
      $("#getCode").attr('disabled', false);
      $("#getCode").removeClass('getcode_disable');
      $("#getCode").addClass('getcode_enable');
      return;
    }

    document.getElementById("timer").innerHTML = count;
  }



   function getValidCode(){
     $.post(
             "/get_code_forget",
             {phone_num: $("#reg_phone").val()},
             'script'
     );
     $("#getCode").attr('disabled', true)
     $("#getCode").removeClass('getcode_enable')
     $("#getCode").addClass('getcode_disable')

     if ($("#timer").length) {
       count = 60;
       counter = setInterval(timer, 1000); //1000 will  run it every 1 second
     }
   }

  function enablecode() {

    if (count == 0) {

      $("#getCode").attr('disabled', false);
      $("#getCode").removeClass('getcode_disable');
      $("#getCode").addClass('getcode_enable');
      $("#reg_phone").removeClass("alert-danger");
      $("#phone_exist").html("");

    }
  }

  function disablecode() {
    if (count == 0) {
      $("#getCode").attr('disabled', true);
      $("#getCode").removeClass('getcode_enable');
      $("#getCode").addClass('getcode_disable');
      $("#reg_phone").addClass("alert-danger");
      $("#phone_exist").html("该号码已经被使用");

    }
  }


  function reg_right() {

    alert("right");
  }


  function reg_wrong() {
    alert("wrong");
  }